
Repository Link: https://github.com/Vish-TechOps/ceres-hands-on-go-kind-master

Containerization hands-on excercise

Prerequisites
==================================
Docker Desktop and Kind deployed
Kind cluster created. See kind/ directory



Prerequisites:-
https://docs.docker.com/docker-for-windows/install/
Install Docker Desktop on Windows
Docker Desktop for Windows is the Community version of Docker for Microsoft Windows. You can download Docker Desktop for Windows from Docker Hub.

https://hub.docker.com/editions/community/docker-ce-desktop-windows/

https://docs.microsoft.com/en-us/windows/wsl/install-win10#step-4---download-the-linux-kernel-update-package


docker run -d -p 80:80 docker/getting-started

================
https://github.com/Vish-TechOps/ceres-hands-on-go-kind-master/tree/master/kind
https://kind.sigs.k8s.io/docs/user/configuration/

<USE this>
https://kind.sigs.k8s.io/docs/user/quick-start

curl.exe -Lo kind-windows-amd64.exe https://kind.sigs.k8s.io/dl/v0.10.0/kind-windows-amd64
Move-Item .\kind-windows-amd64.exe C:\Users\vsingh33\Desktop\Vish-Data-Completed\ceres-hands-on-go-kind-master\ceres-hands-on-go-kind-master\kind.exe

Add in path variable

C:\WINDOWS\system32>kind
kind creates and manages local Kubernetes clusters using Docker container 'nodes'

Usage:
  kind [command]

Available Commands:
  build       Build one of [node-image]
  completion  Output shell completion code for the specified shell (bash, zsh or fish)
  create      Creates one of [cluster]
  delete      Deletes one of [cluster]
  export      Exports one of [kubeconfig, logs]
  get         Gets one of [clusters, nodes, kubeconfig]
  help        Help about any command
  load        Loads images into nodes
  version     Prints the kind CLI version

Flags:
  -h, --help              help for kind
      --loglevel string   DEPRECATED: see -v instead
  -q, --quiet             silence all stderr output
  -v, --verbosity int32   info log verbosity
      --version           version for kind

Use "kind [command] --help" for more information about a command.

Directory of C:\Users\vsingh33\Desktop\Vish-Data-Completed\ceres-hands-on-go-kind-master\ceres-hands-on-go-kind-master\kind

02/08/2021  08:24 PM    <DIR>          .
02/08/2021  08:24 PM    <DIR>          ..
02/08/2021  08:24 PM    <DIR>          data
02/05/2021  04:41 AM               180 kind.yaml
02/05/2021  04:41 AM               619 README.md
               2 File(s)            799 bytes
               3 Dir(s)  334,620,119,040 bytes free

C:\Users\vsingh33\Desktop\Vish-Data-Completed\ceres-hands-on-go-kind-master\ceres-hands-on-go-kind-master\kind>kind create cluster --config kind.yaml
Creating cluster "resideo-hands-on" ...
 â€¢ Ensuring node image (kindest/node:v1.20.2) ğŸ–¼  ...
 âœ“ Ensuring node image (kindest/node:v1.20.2) ğŸ–¼
 â€¢ Preparing nodes ğŸ“¦ ğŸ“¦   ...
 âœ“ Preparing nodes ğŸ“¦ ğŸ“¦
 â€¢ Writing configuration ğŸ“œ  ...
 âœ“ Writing configuration ğŸ“œ
 â€¢ Starting control-plane ğŸ•¹ï¸  ...
 âœ“ Starting control-plane ğŸ•¹ï¸
 â€¢ Installing CNI ğŸ”Œ  ...
 âœ“ Installing CNI ğŸ”Œ
 â€¢ Installing StorageClass ğŸ’¾  ...
 âœ“ Installing StorageClass ğŸ’¾
 â€¢ Joining worker nodes ğŸšœ  ...
 âœ“ Joining worker nodes ğŸšœ
Set kubectl context to "kind-resideo-hands-on"
You can now use your cluster with:

kubectl cluster-info --context kind-resideo-hands-on

Have a nice day! ğŸ‘‹


Task

https://github.com/Vish-TechOps/ceres-hands-on-go-kind-master


 ======================================================================
Cloning and working on task
 
<STEP1>

1) Create Private repo in GitHub
2) Git clone empty repo and unzip ceres-hands-on-go-kind-master.zip
3) Git commands to push changes into Master in repo
4) Visual studio is set for git commands with github repo

<STEP2>
Now follow clsuter creations steps
https://github.com/Vish-TechOps/ceres-hands-on-go-kind-master/tree/master/kind
Creating cluster
Install prerequisites
Chage directory to kind - this will allow you to mount data volume from relative path
Run
- kind create cluster --config kind.yaml4
- kind get clusters
- kubectl cluster-info --context kind-resideo-hands-on
VERIFY IN DOCKER Desktop
Worker node and control plan should be running

<STEP3>
Now work on tasks
https://github.com/Vish-TechOps/ceres-hands-on-go-kind-master
Task section

$ git checkout -b ToDo-App-Feature-Branch
Switched to a new branch 'ToDo-App-Feature-Branch'
Singh33@SLB-F8J81N2 MINGW64 /d/ceres-hands-on-go-kind-master (ToDo-App-Feature-Branch)
$ ls -rlt
total 12
-rw-r--r-- 1 VSingh33 1049089 1381 Feb  8 22:39 README.md
drwxr-xr-x 1 VSingh33 1049089    0 Feb  8 22:39 kind
-rw-r--r-- 1 VSingh33 1049089 5222 Feb  8 22:39 main.go
drwxr-xr-x 1 VSingh33 1049089    0 Feb  8 22:39 static

VSingh33@SLB-F8J81N2 MINGW64 /d/ceres-hands-on-go-kind-master (ToDo-App-Feature-Branch)
$ pwd
/d/ceres-hands-on-go-kind-master
## Clone the source code to your $GOPATH/src directory, use go get . command to run the install the dependencies.

Run below commads on feature branch
export GOPATH=/d/ceres-hands-on-go-kind-master
echo $GOPATH  
$ go env GOPATH
D:/ceres-hands-on-go-kind-master  
go get .
go build

VSingh33@SLB-F8J81N2 MINGW64 /d/ceres-hands-on-go-kind-master (ToDo-App-Feature-Branch)
$ go env GOPATH
D:/ceres-hands-on-go-kind-master

VSingh33@SLB-F8J81N2 MINGW64 /d/ceres-hands-on-go-kind-master (ToDo-App-Feature-Branch)
$ go get .
go get: no install location for directory D:\ceres-hands-on-go-kind-master outside GOPATH
        For more details see: 'go help gopath'

VSingh33@SLB-F8J81N2 MINGW64 /d/ceres-hands-on-go-kind-master (ToDo-App-Feature-Branch)
$ go build

VSingh33@SLB-F8J81N2 MINGW64 /d/ceres-hands-on-go-kind-master (ToDo-App-Feature-Branch)
$ ls -lrt
total 12153
-rw-r--r-- 1 VSingh33 1049089     1381 Feb  8 22:39 README.md
drwxr-xr-x 1 VSingh33 1049089        0 Feb  8 22:39 kind
-rw-r--r-- 1 VSingh33 1049089     5222 Feb  8 22:39 main.go
drwxr-xr-x 1 VSingh33 1049089        0 Feb  8 22:39 static
drwxr-xr-x 1 VSingh33 1049089        0 Feb  8 22:55 src
-rw-r--r-- 1 VSingh33 1049089      200 Feb  8 23:06 Dockerfile
drwxr-xr-x 1 VSingh33 1049089        0 Feb  8 23:14 pkg
-rwxr-xr-x 1 VSingh33 1049089 12428800 Feb  8 23:44 ceres-hands-on-go-kind-master.exe

VSingh33@SLB-F8J81N2 MINGW64 /d/ceres-hands-on-go-kind-master (ToDo-App-Feature-Branch)



Binary will be created => ceres-hands-on-go-kind-master.exe

Change binary name to todo-app-go
$ mv ceres-hands-on-go-kind-master.exe todo-app-go

Build an Image
$ docker build -t todo-app-go:v1.0.0 .
kind load docker-image todo-app-go:v1.0.0

VSingh33@SLB-F8J81N2 MINGW64 /d/ceres-hands-on-go-kind-master (ToDo-App-Feature-Branch)
$ docker build -t todo-app-go:v1.0.0 .
[+] Building 13.4s (11/11) FINISHED
 => [internal] load build definition from Dockerfile                                                                                                                                                                 0.1s 
 => => transferring dockerfile: 239B                                                                                                                                                                                 0.0s 
 => [internal] load .dockerignore                                                                                                                                                                                    0.1s 
 => => transferring context: 2B                                                                                                                                                                                      0.0s 
 => [internal] load metadata for docker.io/woahbase/alpine-glibc:latest                                                                                                                                              3.8s 
 => [auth] woahbase/alpine-glibc:pull token for registry-1.docker.io                                                                                                                                                 0.0s 
 => [internal] load build context                                                                                                                                                                                    0.2s 
 => => transferring context: 12.43MB                                                                                                                                                                                 0.2s 
 => [1/5] FROM docker.io/woahbase/alpine-glibc:latest@sha256:6940e2d7e1134cdd995b7745d4e2a0c1b99dab98b5c6a44fb8f0f6b7016a7b76                                                                                        2.7s 
 => => resolve docker.io/woahbase/alpine-glibc:latest@sha256:6940e2d7e1134cdd995b7745d4e2a0c1b99dab98b5c6a44fb8f0f6b7016a7b76                                                                                        0.0s 
 => => sha256:c218d1e44a3492c48fcc7873411443c605a5950b7432efb08f725acb35c5f43a 3.31MB / 3.31MB                                                                                                                       1.9s 
 => => sha256:6940e2d7e1134cdd995b7745d4e2a0c1b99dab98b5c6a44fb8f0f6b7016a7b76 1.16kB / 1.16kB                                                                                                                       0.0s 
 => => sha256:3bb730fa5319f3ffe8fd65208f8161f565be4a131ae4f5f720dcf342ce00bed4 7.19kB / 7.19kB                                                                                                                       0.0s 
 => => sha256:0503825856099e6adb39c8297af09547f69684b7016b7f3680ed801aa310baaa 2.79MB / 2.79MB                                                                                                                       0.8s 
 => => sha256:f2b03e06b29f65a862004ba4c341cb0db203bfbd836bd5644dc2b41eea6d61f4 1.80MB / 1.80MB                                                                                                                       1.1s 
 => => extracting sha256:0503825856099e6adb39c8297af09547f69684b7016b7f3680ed801aa310baaa                                                                                                                            0.3s 
 => => sha256:03b06ad5e57dd43ba123feac15be00430e7c7c79e788e4e2ceecc8b23c3da413 5.60MB / 5.60MB                                                                                                                       2.1s 
 => => extracting sha256:f2b03e06b29f65a862004ba4c341cb0db203bfbd836bd5644dc2b41eea6d61f4                                                                                                                            0.1s 
 => => extracting sha256:c218d1e44a3492c48fcc7873411443c605a5950b7432efb08f725acb35c5f43a                                                                                                                            0.2s 
 => => extracting sha256:03b06ad5e57dd43ba123feac15be00430e7c7c79e788e4e2ceecc8b23c3da413                                                                                                                            0.2s 
 => [2/5] RUN apk update && apk add ca-certificates && rm -rf /var/cache/apk/*                                                                                                                                       5.8s 
 => [3/5] COPY todo-app-go bin/                                                                                                                                                                                      0.1s 
 => [4/5] WORKDIR bin                                                                                                                                                                                                0.1s 
 => [5/5] RUN chmod +x todo-app-go                                                                                                                                                                                   0.6s 
 => exporting to image                                                                                                                                                                                               0.2s 
 => => exporting layers                                                                                                                                                                                              0.2s 
 => => writing image sha256:96e17e23ba622765672bc3e7e078d0afd19e14832c34df4af0665fc41bd39101                                                                                                                         0.0s 
 => => naming to docker.io/library/todo-app-go:v1.0.0                                                                                                                                                                0.0s 

VSingh33@SLB-F8J81N2 MINGW64 /d/ceres-hands-on-go-kind-master (ToDo-App-Feature-Branch)
$ Docker images
REPOSITORY               TAG       IMAGE ID       CREATED          SIZE
todo-app-go              v1.0.0    96e17e23ba62   32 seconds ago   55.1MB
kindest/node             <none>    094599011731   2 weeks ago      1.17GB
docker/getting-started   latest    3c156928aeec   9 months ago     24.8MB


<STEP4>
Operations - Create containers or pods in kubernetes
Make your image available in Kind cluster
kind load docker-image <image_tag> --name resideo-hands-on
kind load docker-image todo-app-go:v1.0.0 --name resideo-hands-on

VSingh33@SLB-F8J81N2 MINGW64 /d/ceres-hands-on-go-kind-master (ToDo-App-Feature-Branch)
$ kind load docker-image todo-app-go:v1.0.0 --name resideo-hands-on
Image: "todo-app-go:v1.0.0" with ID "sha256:96e17e23ba622765672bc3e7e078d0afd19e14832c34df4af0665fc41bd39101" not yet present on node "resideo-hands-on-worker", loading...
Image: "todo-app-go:v1.0.0" with ID "sha256:96e17e23ba622765672bc3e7e078d0afd19e14832c34df4af0665fc41bd39101" not yet present on node "resideo-hands-on-control-plane", loading...


VSingh33@SLB-F8J81N2 MINGW64 /d/ceres-hands-on-go-kind-master (ToDo-App-Feature-Branch)
$ docker run -itd --name resideo-hands-on todo-app-go:v1.0.0
69a9c599347cc4a53a4ebd33f7f34185070711e8bab34f3d7b63a35afa94e277

<STEP5>
Cleanup
Remove Kind cluster

kind delete cluster --name resideo-hands-on
Remove Mongo data

rm -rf kind/data/*


============================
ISSUE FACED DURING GO GET AND GO Build
VSingh33@SLB-F8J81N2 MINGW64 /d/ceres-hands-on-go-kind-master (ToDo-App-Feature-Branch)
$ go build
# github.com/go-chi/chi
src\github.com\go-chi\chi\tree.go:60:20: invalid operation: 2 << n (shift count type int, must be unsigned integer)

VSingh33@SLB-F8J81N2 MINGW64 /d/ceres-hands-on-go-kind-master (ToDo-App-Feature-Branch)
$ go get github.com/go-chi/chi
# github.com/go-chi/chi
src\github.com\go-chi\chi\tree.go:60:20: invalid operation: 2 << n (shift count type int, must be unsigned integer)


VSingh33@SLB-F8J81N2 MINGW64 /d/ceres-hands-on-go-kind-master (ToDo-App-Feature-Branch)
$ go version
go version go1.11.13 windows/amd64

Upgraed go
https://golang.org/dl/
Download and Install

